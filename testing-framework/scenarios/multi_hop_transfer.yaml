name: "Multi-Hop Transfer"
description: "Test multiple transfers creating a payment chain: Alice → Bob → Charlie → Dave"

genesis:
  accounts:
    - name: "alice"
      balance: "1000000000000"  # 1000 TOS
    - name: "bob"
      balance: "0"
    - name: "charlie"
      balance: "0"

steps:
  # Hop 1: Alice → Bob (500 TOS)
  - action: "transfer"
    from: "alice"
    to: "bob"
    amount: "500000000000"
    fee: "100"

  - action: "mine_block"

  - action: "assert_balance"
    account: "alice"
    eq: "499999999900"  # 1000 - 500 - 0.0000001

  - action: "assert_balance"
    account: "bob"
    eq: "500000000000"

  # Hop 2: Bob → Charlie (300 TOS)
  - action: "transfer"
    from: "bob"
    to: "charlie"
    amount: "300000000000"
    fee: "100"

  - action: "mine_block"

  - action: "assert_balance"
    account: "bob"
    eq: "199999999900"  # 500 - 300 - 0.0000001

  - action: "assert_balance"
    account: "charlie"
    eq: "300000000000"

  # Hop 3: Charlie → Dave (200 TOS)
  - action: "transfer"
    from: "charlie"
    to: "dave"
    amount: "200000000000"
    fee: "100"

  - action: "mine_block"

  - action: "assert_balance"
    account: "charlie"
    eq: "99999999900"  # 300 - 200 - 0.0000001

  - action: "assert_balance"
    account: "dave"
    eq: "200000000000"

  # Verify final distribution
  - action: "assert_balance"
    account: "alice"
    compare:
      lte: "500000000000"  # Less than half of original

  - action: "assert_balance"
    account: "dave"
    eq: "200000000000"  # Received 200 TOS

  # Verify nonces
  - action: "assert_nonce"
    account: "alice"
    eq: 1

  - action: "assert_nonce"
    account: "bob"
    eq: 1

  - action: "assert_nonce"
    account: "charlie"
    eq: 1
