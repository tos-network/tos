# Multi-Hop Transfer Scenario
# Tests chain of transfers: alice -> bob -> charlie -> dave

name: "Multi-Hop Transfer"
description: "Chain of transfers through multiple accounts"

genesis:
  accounts:
    - name: "alice"
      balance: "10000000000"  # 10 TOS
    - name: "bob"
      balance: "5000000000"   # 5 TOS
    - name: "charlie"
      balance: "2000000000"   # 2 TOS

steps:
  # Hop 1: alice -> bob
  - action: "transfer"
    from: "alice"
    to: "bob"
    amount: "3000000000"  # 3 TOS
    fee: "100"
    expect:
      status: "success"

  - action: "mine_block"

  # Hop 2: bob -> charlie
  - action: "transfer"
    from: "bob"
    to: "charlie"
    amount: "2000000000"  # 2 TOS
    fee: "100"
    expect:
      status: "success"

  - action: "mine_block"

  # Hop 3: charlie -> dave (new account)
  - action: "transfer"
    from: "charlie"
    to: "dave"
    amount: "1500000000"  # 1.5 TOS
    fee: "100"
    expect:
      status: "success"

  - action: "mine_block"

  # Verify final balances
  # alice: 10 - 3 - 0.0000001 = 6999999900
  - action: "assert_balance"
    account: "alice"
    eq: "6999999900"

  # bob: 5 + 3 - 2 - 0.0000001 = 5999999900
  - action: "assert_balance"
    account: "bob"
    eq: "5999999900"

  # charlie: 2 + 2 - 1.5 - 0.0000001 = 2499999900
  - action: "assert_balance"
    account: "charlie"
    eq: "2499999900"

  # dave: 1.5 = 1500000000
  - action: "assert_balance"
    account: "dave"
    eq: "1500000000"

  # Verify nonces
  - action: "assert_nonce"
    account: "alice"
    eq: 1

  - action: "assert_nonce"
    account: "bob"
    eq: 1

  - action: "assert_nonce"
    account: "charlie"
    eq: 1
