# TOS-TCK AI-Assisted Testing Workflows

This directory contains workflows for AI-assisted test generation using Claude Code and OpenAI Codex.

## Overview

AI-assisted testing accelerates test coverage by automatically generating test cases from source code and specifications.

## Available Workflows

### 1. Claude Code Workflow

Use Claude Code for interactive test generation:

```bash
# Generate syscall tests
cd ~/tos
claude-code "Generate comprehensive tests for the transfer syscall using the template in tck/ai-testing/prompts/syscall_test_generator.md"

# Generate security tests
claude-code "Review daemon/src/core/blockchain.rs and generate security tests using tck/ai-testing/prompts/security_test_generator.md"

# Generate conformance specs
claude-code "Create YAML conformance specs for the balance syscalls using tck/ai-testing/prompts/conformance_spec_generator.md"
```

### 2. Batch Generation

For bulk test generation:

```bash
# Generate tests for all syscalls
for syscall in balance storage call event environment; do
    claude-code "Generate tests for ${syscall} syscalls" > tck/ai-testing/generated/${syscall}_tests.rs
done
```

### 3. Review Workflow

After generation, review and integrate:

1. **Review**: Check generated tests for correctness
2. **Refine**: Fix any issues or add missing cases
3. **Integrate**: Move approved tests to `tck/tests/`
4. **Run**: Execute tests with `cargo test -p tos-tck`

## Quality Metrics

Track AI-generated test quality:

| Metric | Target |
|--------|--------|
| Tests generated | 200+ |
| Tests passing | 95%+ |
| Code coverage increase | +15% |
| Security bugs found | 5+ |

## Best Practices

1. **Always review** - Never commit AI-generated tests without review
2. **Test the tests** - Ensure generated tests actually catch bugs
3. **Iterative refinement** - Use feedback to improve prompts
4. **Track provenance** - Mark AI-generated tests with comments

## Generated Test Header

All AI-generated tests should include:

```rust
//! AI-Generated Test Suite
//!
//! Generated by: Claude Code / OpenAI Codex
//! Date: YYYY-MM-DD
//! Prompt: prompts/syscall_test_generator.md
//!
//! Review status: [PENDING|REVIEWED|APPROVED]
//! Reviewer: [name]
```

## Integration with CI

AI-generated tests are run in CI after approval:

```yaml
# .github/workflows/ai-tests.yml
- name: Run AI-generated tests
  run: cargo test -p tos-tck --test ai_generated_*
```
