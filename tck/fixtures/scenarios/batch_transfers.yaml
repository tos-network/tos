fixture:
  name: "batch_transfers"
  version: "1.0"
  description: "Multiple transfers in a single block"
  tier: [1]

setup:
  accounts:
    alice:
      balance: "100000 TOS"
      nonce: 0
    bob:
      balance: "100000 TOS"
      nonce: 0
    charlie:
      balance: "0 TOS"
      nonce: 0
    dave:
      balance: "0 TOS"
      nonce: 0

steps:
  - batch:
      - transaction:
          from: alice
          to: charlie
          amount: "10000 TOS"
          fee: "10 TOS"
          expected_result: success
      - transaction:
          from: bob
          to: dave
          amount: "20000 TOS"
          fee: "10 TOS"
          expected_result: success

expected_state:
  alice:
    balance: "89990 TOS"
    nonce: 1
  bob:
    balance: "79990 TOS"
    nonce: 1
  charlie:
    balance: "10000 TOS"
  dave:
    balance: "20000 TOS"

invariants:
  - balance_conservation:
      total_supply_change: "-20 TOS"
  - no_negative_balances: true
